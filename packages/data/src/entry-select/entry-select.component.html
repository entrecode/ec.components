<div class="ec-entry-select" *ngIf="selection">
  <div class="ec-select" [class.ec-select_solo]="solo" [class.ec-select_dirty]="selection.items.length" (click)="pop.toggle()&&clickInside($event)">
    <!-- [class.is-focus]="pop?.visible": currently throws error... -->
    <span class="ec-select__placeholder" *ngIf="!selection.items.length">
      {{placeholder||'Ausw√§hlen'}}
    </span>
    <ul class="ec-select-selected" *ngIf="selection.items.length">
      <li *ngFor="let selected of selection?.items">
        <span [class.tag]="!solo" (mousedown)="clickItem(selected)">
          {{selected.display()}}
          <a (mousedown)="selection.remove(selected)" *ngIf="!solo">&times;</a>
        </span>
      </li>
    </ul>
    <ec-pop (click)="clickInside($event)" [ngClass]="field?.nestedPopClass || 'ec-select-options'" #crudPop [active]="field?.nestedPopActive"
      [visible]="field?.nestedPopVisible">
      <!-- TODO find way to embed close button to the pops that need it -->
      <ec-crud [model]="model" *ngIf="selection&&crudPop.active" [config]="config" [selection]="selection" (columnClicked)="select($event)"
        #crud></ec-crud>
    </ec-pop>
    <ec-pop (click)="clickInside($event)" class="ec-pop_dialog" #listPop>
      <!-- TODO: make pop configurable -->
      <header class="ec-pop-header">
        <button (click)="listPop.hide()" type="button" class="ec-pop__dismiss">
          <ec-icon name="close-x-big"></ec-icon>
        </button>
      </header>
      <div class="ec-pop-body">
        <!-- TODO find way to embed close button to the pops that need it -->
        <ec-crud [model]="model" *ngIf="listPop.active" [config]="config" [selection]="selection" (columnClicked)="select($event)"></ec-crud>
      </div>
    </ec-pop>
  </div>
  <!--TODO link to open a ec-pop with an ec-list like now in .select-options-->
  <nav class="ec-entry-select__controls">
    <a (click)="listPop.show()" class="btn btn_clear">
      <ec-icon name="list-bullets"></ec-icon>
    </a>
  </nav>
</div>