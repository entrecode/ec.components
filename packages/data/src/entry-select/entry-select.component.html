<div class="ec-entry-select" *ngIf="selection">
  <div class="ec-select" [class.is-solo]="solo" [class.is-dirty]="selection.items.length" (click)="pop.toggle()&&clickInside($event)">
    <span class="ec-select__placeholder" *ngIf="!selection.items.length">
      {{placeholder||'make your selection...'}}
    </span>
    <span class="ec-select-selected" (click)="clickItem(selection.items[0],$event)" *ngIf="selection.items.length&&solo">
      {{selection.items[0].display()}}
      <a (click)="removeItem(selection.items[0],$event)">&times;</a>
    </span>
    <ul class="ec-select-selection" *ngIf="selection.items.length&&!solo" dndDropzone (dndDrop)="onDrop($event)">
      <li [dndDisableIf]="solo||config?.disableDrag" [class.is-dragged]="selected===dragged" [class.is-draggable]="solo||!config?.disableDrag"
        dndEffectAllowed="move" [dndDraggable]="selected" *ngFor="let selected of selection?.items" (dndStart)="onDragStart(selected,$event)"
        (dndCanceled)="cancelDrag(selected,$event)" (dndEnd)="cancelDrag(selected,$event)">
        <span class="ec-select-selected" (click)="!solo&&editItem(selected,$event)">
          {{selected.display()}}
          <a (click)="removeItem(selected,$event)">&times;</a>
        </span>
      </li>
      <li dndPlaceholderRef>
        <!-- TODO change to width of dragged element -->
        <div class="drag-placeholder" style="width: 48px;"></div>
      </li>
    </ul>
    <!-- Dropdown -->
    <ec-pop (click)="clickInside($event)" [ngClass]="config?.nestedPopClass || 'ec-select-options'" #dropdown [active]="config?.nestedPopActive"
      [visible]="config?.nestedPopVisible">
      <ec-entry-list [model]="model" *ngIf="selection&&dropdown.active" [config]="dropdownConfig" [selection]="selection" (columnClicked)="select($event)"></ec-entry-list>
    </ec-pop>
    <!-- popup -->
    <!-- <ec-pop (click)="clickInside($event)" [ngClass]="getPopClass()" #listPop>
      <header class="ec-pop-header">
        <button (click)="listPop.hide()" type="button" class="ec-pop__dismiss">
          <ec-icon name="close-x-big"></ec-icon>
        </button>
      </header>
      <div class="ec-pop-body" *ngIf="listPop.active&&lightModel">
        <ec-searchbar placeholder="Suche.." [list]="entryList" *ngIf="entryList" [property]="lightModel.titleField"></ec-searchbar>
        <ec-entry-list [model]="model" [config]="config" [selection]="selection" (columnClicked)="select($event)" #entryList></ec-entry-list>
      </div>
    </ec-pop> -->
    <ec-entry-list-pop (click)="clickInside($event)" [model]="model" [ngClass]="getPopClass()" [config]="config" [selection]="selection" #listPop></ec-entry-list-pop>
  </div>
  <ec-entry-pop #entryPop [model]="model" [ngClass]="getPopClass()" [config]="config" (submitted)="formSubmitted($event)" (deleted)="removeItem($event)"></ec-entry-pop>
  <nav class="ec-entry-select__controls">
    <a (click)="editItem(selection.items[0],$event)" class="btn btn_clear" *ngIf="solo&&!config.disableCreatePop&&hasMethod('put')&&!selection.isEmpty()">
      <ec-icon name="pencil"></ec-icon>
    </a>
    <a (click)="listPop.show()" class="btn btn_clear" *ngIf="!config.disableListPop&&hasMethod('get')">
      <ec-icon name="list-bullets"></ec-icon>
    </a>
    <a (click)="entryPop.create()" class="btn btn_clear" *ngIf="!config.disableCreatePop&&hasMethod('post')">
      <ec-icon name="add"></ec-icon>
    </a>
  </nav>
</div>