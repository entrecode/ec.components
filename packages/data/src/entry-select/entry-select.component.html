<div *ngIf="!model">
  <select class="input" (change)="useModel($event.target.value)">
    <option>{{'entry.select.placeholder.model'|symbol}}</option>
    <option *ngFor="let model of models" [value]="model.title">
      {{model.title}}
    </option>
  </select>
</div>

<div class="ec-entry-select">
  <div class="ec-select" [class.ec-select_solo]="solo" [class.is-dirty]="!selection?.isEmpty()" (click)="togglePop($event)">
    <span class="ec-select__placeholder" *ngIf="config?.disableSelect&&selection.isEmpty()">
      {{config?.placeholder||placeholder||defaultPlaceholder()}}
    </span>
    <ul class="ec-select-selection" *ngIf="selection?.display?.length" dndDropzone (dndDrop)="onDrop($event)">
      <li [dndDisableIf]="solo||config?.disableDrag" [class.is-dragged]="selected===dragged" [class.is-draggable]="solo||!config?.disableDrag"
        dndEffectAllowed="move" [dndDraggable]="i" *ngFor="let selected of selection?.display;let i = index" (dndStart)="onDragStart(selected,$event)"
        (dndCanceled)="cancelDrag(selected,$event)" (dndEnd)="cancelDrag(selected,$event)">
        <span [class.ec-select-selected]="!solo" [class.ec-select-selected_solo]="solo" (click)="!solo&&editItem(selected,$event)">
          {{selected.display()}}
          <a (click)="removeItem(selected,false,$event)">&times;</a>
        </span>
      </li>
      <li dndPlaceholderRef>
        <!-- TODO change to width of dragged element -->
        <div class="drag-placeholder" style="width: 48px;"></div>
      </li>
    </ul>
    <!-- Dropdown -->

    <!--<ec-pop [ngClass]="config?.nestedPopClass || 'ec-select-options'" #dropdown *ngIf="!config?.disableSelect">
      <ec-list [items]="models" *ngIf="!model" [config]="modelDropdownConfig" (columnClicked)="selectModel($event)"></ec-list>
      
      <div class="ec-list" *ngIf="model">
        <div class="ec-list-body">
          <div class="ec-list-group">
            <div class="ec-list-group-header">
              <div class="ec-list-cell">
                <a class="ec-list-group-header__title" (click)="switchModel($event)">{{model}}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <ec-resource-list #entryList [relation]="'model.'+model" [api]="sdk.api" *ngIf="model" [config]="dropdownConfig" [selection]="selection"
        (click)="$event.preventDefault();$event.stopPropagation()" (columnClicked)="select($event)"></ec-resource-list> &&selection&&dropdown.active -->

    <ec-searchbar *ngIf="!config?.disableSelect" [autofocus]="false" [property]="config?.label" [placeholder]="placeholder||defaultPlaceholder()"
      (keypressed)="handleKey($event,dropdownList)" (focus)="focus($event)"
      (queryChanged)="filterDropdownList(dropdownList,$event)"></ec-searchbar>
    <ec-pop *ngIf="!config?.disableSelect" class="ec-select-options" #dropdown [hideOnClickOutside]="true">
      <ec-loader class="ec-loader ec-loader_local" #dropdownLoader></ec-loader>
      <ec-entry-list #dropdownList [selection]="selection" *ngIf="dropdown.activated" [model]="model" [config]="dropdownConfig"
        [loader]="dropdownLoader" (columnClicked)="select($event)"></ec-entry-list>
    </ec-pop>
  </div>
  <!-- Fully fledged entryListPop -->
  <ec-entry-list-pop (columnClicked)="select($event)" [model]="model" class="ec-entry-list-pop" [config]="config"
    [selection]="selection" #entryListPop></ec-entry-list-pop>
  <ec-resource-delete-pop [question]="'entry.select.delete.question' | symbol" #confirmDelete></ec-resource-delete-pop>

  <ec-entry-pop #entryPop *ngIf="config" [model]="model" [config]="config" (submitted)="formSubmitted($event)"
    (deleted)="removeItem($event,true)"></ec-entry-pop>

  <nav class="ec-entry-select__controls">
    <a (click)="editItem(selection?.display[0],$event)" class="btn btn_clear" *ngIf="solo&&!config?.disableCreatePop&&hasMethod('put')&&!selection?.isEmpty()">
      <ec-icon name="pencil"></ec-icon>
    </a>
    <a (click)="entryPop.create()" class="btn btn_clear" *ngIf="!config?.disableCreatePop&&hasMethod('post')&&(!solo||selection?.isEmpty())">
      <ec-icon name="add"></ec-icon>
    </a>
    <a (click)="entryListPop.show()" class="btn btn_clear" *ngIf="!config?.disableListPop&&hasMethod('get')">
      <ec-icon name="find"></ec-icon>
    </a>
  </nav>
</div>