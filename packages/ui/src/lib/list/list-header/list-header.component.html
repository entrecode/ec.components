<div *ngIf="filterFormConfig">
  <ec-form [config]="filterFormConfig" [value]="list?.config?.filter" [empty]="true" #filterForm
    (ready)="initFilterForm($event)" [lazy]="true"></ec-form>
  <ec-pop (toggle)="toggledFilterPop($event)" #filterPop>
    <div *ngIf="filteredField" class="btn-group">
      <nav tabindex="0" class="dropdown dropdown-left">
        <span class="btn btn_clear">
          <ec-icon name="find">{{fieldLabel(filteredField)}}</ec-icon>
        </span>
        <ul class="dropdown-options">
          <li [class.is-active]="filteredField.property===field.property" class="dropdown-option"
            *ngFor="let field of list?.filterableFields()">
            <a (click)="editFilter(filterPop, field.property)">{{fieldLabel(field)}}</a>
          </li>
        </ul>
      </nav>
      <ec-input (changed)="setFilter(filteredField, $event)" [lazy]="true" class="has-width-full"
        [field]="filteredField" [group]="filterForm?.group" [debounce]="200" *ngIf="filterPop.active&&filterForm?.group"
        #filterInput></ec-input>
      <a class="btn btn_clear" (click)="filterPop.hide()">
        <ec-icon name="close-x-big"></ec-icon>
      </a>
    </div>
  </ec-pop>

  <div class="ec-list-header">
    <div class="ec-list-cell ec-list-item__selector" *ngIf="list?.config?.selectMode&&!list?.isEmpty()">
      <input type="checkbox" (click)="selection?.toggleAll(list?.page)" [checked]="selection?.hasAll(list?.page)"
        [disabled]="selection?.config?.solo">
    </div>
    <div class="ec-list-cell" *ngFor="let field of list?.fields;let i = index"
      [ngClass]="'ec-list-cell_' + field.view + ' ' + field?.classes" [class.is-hidden]="field.hideInList"
      [class.is-sortable]="field.sortable" [class.is-sorted]="list.isSorted(field.property)"
      [class.is-filterable]="field.filterable" [class.is-filtered]="list.isFiltered(field.property)"
      [class.is-sorted-desc]="list.isSorted(field.property, true)"
      [class.is-sorted-asc]="list.isSorted(field.property, false)">
      <!-- [class.is-filter-active]="filterPop.active"-->
      <a (click)="editFilter(filterPop, field.property)" class="is-filterable-control" *ngIf="field.filterable">
        <ec-icon name="find"></ec-icon>
      </a>

      <span class="ec-list-column-title" (click)="field.sortable&&list.toggleSort(field.property)">
        {{fieldLabel(field)}}
      </span>
      <span class="is-sortable-indicator" *ngIf="field.sortable" (click)="list.toggleSort(field.property)"></span>
    </div>


    <div class="dropdown dropdown_right ec-list-column-filter" tabindex="0" *ngIf="!list?.config?.disableColumnFilter">
      <span>&#9776;</span>
      <div class="dropdown-options ec-list-column-filter-options">
        <ul>
          <li class="ec-list-column-filter-option" *ngFor="let field of list?.fields"
            [class.is-active]="!field.hideInList" [class.is-hidden]="field.hideInColumnFilter">
            <div class="form-boolean" (click)="toggleVisibility(field)">
              <ec-icon [name]="field.hideInList?'square':'check-box'">{{fieldLabel(field)}}</ec-icon>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>