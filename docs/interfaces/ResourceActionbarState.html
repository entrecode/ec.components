<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ec.components documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ec.components documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>ResourceActionbarState</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>packages/data/src/lib/resource-actionbar/resource-actionbar.component.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#action">action</a>
                                </li>
                                <li>
                                        <a href="#actionbar">actionbar</a>
                                </li>
                                <li>
                                        <a href="#api">api</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#options">options</a>
                                </li>
                                <li>
                                        <a href="#relation">relation</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="action"></a>
                                        <span class="name"><b>action</b><a href="#action"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>action:         <code><a href="../interfaces/Action.html" target="_self" >ActionFunction</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../interfaces/Action.html" target="_self" >ActionFunction</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="actionbar"></a>
                                        <span class="name"><b>actionbar</b><a href="#actionbar"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>actionbar:         <code><a href="../interfaces/Action.html" target="_self" >ActionbarComponent</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../interfaces/Action.html" target="_self" >ActionbarComponent</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="api"></a>
                                        <span class="name"><b>api</b><a href="#api"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>api:     <code>Core</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>Core</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="options"></a>
                                        <span class="name"><b>options</b><a href="#options"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>options:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" >Object</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" >Object</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="relation"></a>
                                        <span class="name"><b>relation</b><a href="#relation"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>relation:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit, ElementRef, Input, ChangeDetectorRef, EventEmitter, Output } from &#x27;@angular/core&#x27;;
import { ActionbarComponent, Action, ActionFunction, selectTemplate } from &#x27;@ec.components/ui&#x27;;
import { NotificationsService, ListComponent } from &#x27;@ec.components/ui&#x27;;
import { ResourceConfig } from &#x27;../resource-config/resource-config.service&#x27;;
import ListResource from &#x27;ec.sdk/lib/resources/ListResource&#x27;;
import Core from &#x27;ec.sdk/lib/Core&#x27;;
import { Item } from &#x27;@ec.components/core&#x27;;
import { SdkService } from &#x27;../sdk/sdk.service&#x27;;

export interface ResourceActionbarState {
  api: Core;
  relation: string;
  actionbar: ActionbarComponent;
  action?: ActionFunction;
  options?: Object;
}

@Component({
  selector: &#x27;ec-resource-actionbar&#x27;,
  template: selectTemplate,
})
export class ResourceActionbarComponent extends ActionbarComponent implements OnInit {
  state: ResourceActionbarState;

  @Output() create: EventEmitter&lt;string&gt; &#x3D; new EventEmitter();
  @Output() select: EventEmitter&lt;Item&lt;Action&gt;&gt; &#x3D; new EventEmitter();

  @Input() actions: Action[];

  constructor(
    public notificationService: NotificationsService,
    public sdk: SdkService,
    public resourceConfig: ResourceConfig,
    public elementRef: ElementRef,
    public cdr: ChangeDetectorRef,
  ) {
    super(elementRef, cdr);
  }

  ngOnInit() {
    const state &#x3D; {
      api: this.sdk.api,
      relation: &#x27;tags&#x27;,
    };
    const { api, relation } &#x3D; state;
    this.sdk.ready.then(() &#x3D;&gt; {
      this.loadResourceListActions({
        api,
        relation,
        actionbar: this,
      });
    });
  }

  getResourceListActions(listResource: ListResource, relation: string, action?: ActionFunction): Action[] {
    const actions: Action[] &#x3D; listResource.getAllItems().map((resource) &#x3D;&gt; {
      const { identifier, label } &#x3D; this.resourceConfig.get(relation);
      return {
        id: resource[identifier],
        title: resource[label] || &#x27;- no title -&#x27;,
        data: resource,
        path: relation,
        action: (item, bar) &#x3D;&gt; {
          if (action) {
            action(item.getBody().data, bar);
          } else {
            console.log(&#x27;no action specified..&#x27;);
          }
        },
      };
    });
    if (listResource.hasNextLink()) {
      actions.push({
        id: &#x27;next-page&#x27;,
        title: &#x60;Load Page&#x60;,
        path: null,
        data: {},
        select: false,
        action: () &#x3D;&gt; {
          listResource.followNextLink().then((list) &#x3D;&gt; {
            const concatted &#x3D; this.list.items
              .map((i) &#x3D;&gt; i.getBody())
              .filter((i) &#x3D;&gt; i.id !&#x3D;&#x3D; &#x27;next-page&#x27;)
              .concat(this.getResourceListActions(list, relation, action));
            this.loadActions(concatted);
          });
        },
      });
    }
    return actions;
  }

  reload() {
    this.loadResourceListActions({
      ...this.state,
      options: {},
    });
  }

  loadResourceListActions(state: ResourceActionbarState &#x3D; this.state, stack &#x3D; true): Promise&lt;Action[]&gt; {
    const { api, relation, actionbar, action, options } &#x3D; state;
    this.state &#x3D; {
      ...this.state,
      ...state,
    };
    const loading &#x3D; api
      .resourceList(relation, options)
      .then((list) &#x3D;&gt; {
        return this.getResourceListActions(list, relation, action);
      })
      .then((actions) &#x3D;&gt; {
        if (actions) {
          actionbar.loadActions(actions, stack);
        }
        return actions;
      })
      .catch((error) &#x3D;&gt; {
        this.notificationService.emit({
          title: &#x27;Error while loading Resources&#x27;,
          error,
        });
      })
      .then((actions) &#x3D;&gt; actions || []);
    if (actionbar.dropdownLoader) {
      actionbar.dropdownLoader.wait(loading);
    }
    return loading;
  }

  resourceAction({
    relation,
    title,
    api,
    action,
    actionbar,
    add,
    path,
  }: {
    relation: string;
    title: string;
    api: Core;
    action?: ActionFunction;
    actionbar?: ActionbarComponent;
    add?: boolean;
    path?: string;
  }) {
    return {
      id: path || relation,
      title: title,
      add,
      action: () &#x3D;&gt; this.loadResourceListActions({ api, relation, actionbar, action }),
    };
  }

  filterDropdownList(listComponent: ListComponent&lt;any&gt;, query) {
    const paths &#x3D; this.currentActions()
      .map((a) &#x3D;&gt; a.path)
      .filter((value, index, self) &#x3D;&gt; self.indexOf(value) &#x3D;&#x3D;&#x3D; index)
      .filter((v) &#x3D;&gt; !!v);
    if (!paths.length) {
      return super.filterDropdownList(listComponent, query);
    }
    const { identifier, label } &#x3D; this.resourceConfig.get(this.state.relation);
    this.loadResourceListActions(
      {
        ...this.state,
        options: {
          [label + &#x27;~&#x27;]: { exact: query },
        },
      },
      false,
    ).then((actions) &#x3D;&gt; {
      if (actions.length &#x3D;&#x3D;&#x3D; 0) {
        this.loadActions(
          [
            {
              title: &#x60;&quot;${query}&quot; erstellen&#x60;,
              id: &#x27;createnew&#x27;,
              select: false,
              action: () &#x3D;&gt; {
                if (this.create.observers.length) {
                  this.create.emit(query);
                } else {
                  const item &#x3D; new Item(
                    {
                      id: Date.now() + &#x27;&#x27;,
                      title: query,
                    },
                    this.config,
                  );
                  this.addItem(item);
                  this.searchbar.clear();
                  this.reload();
                }
              },
            },
          ],
          false,
        );
      }
    });
  }
}
</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'publishing.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
